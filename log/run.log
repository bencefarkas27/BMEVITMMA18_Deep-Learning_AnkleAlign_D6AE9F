Run wget --no-verbose to download dataset from https://bmeedu-my.sharepoint.com/:u:/g/personal/gyires-toth_balint_vik_bme_hu/IQB8kDcLEuTqQphHx7pv4Cw5AW7XMJp5MUbwortTASU223A?e=Uu6CTj&download=1&xsdata=MDV8MDJ8fDIyOTc1YmYyMWMzNzQyODFlZWZhMDhkZTM3YmNkMjdifDZhMzU0OGFiNzU3MDQyNzE5MWE4NThkYTAwNjk3MDI5fDB8MHw2MzkwMDk0ODEyNTc5MDU5MTR8VW5rbm93bnxWR1ZoYlhOVFpXTjFjbWwwZVZObGNuWnBZMlY4ZXlKRFFTSTZJbFJsWVcxelgwRlVVRk5sY25acFkyVmZVMUJQVEU5R0lpd2lWaUk2SWpBdU1DNHdNREF3SWl3aVVDSTZJbGRwYmpNeUlpd2lRVTRpT2lKUGRHaGxjaUlzSWxkVUlqb3hNWDA5fDF8TDNSbFlXMXpMekU1T2xSM1NIcHViVlpTVlVKUGFGUjFRVTFyWlc1blIyVlhTSEkzYjB0WVNWQkNTamxxTWtKbkxVdFdkMnN4UUhSb2NtVmhaQzUwWVdOMk1pOWphR0Z1Ym1Wc2N5OHhPVHBVZDBoNmJtMVdVbFZDVDJoVWRVRk5hMlZ1WjBkbFYwaHlOMjlMV0VsUVFrbzVhakpDWnkxTFZuZHJNVUIwYUhKbFlXUXVkR0ZqZGpJdmJXVnpjMkZuWlhNdk1UYzJOVE0xTVRNeU5ETTJPQT09fDBiYmVmZWIwYWJmOTRkZTFlZWZhMDhkZTM3YmNkMjdifGRlNDNhNjEyMWZmNzQxOTk4OGJiYzk4ZWMzZjU4MTdk&sdata=SWRDUWQrSVVCZTViZ05ZVEp2dU10ZFhJWG90RTdYZCtxSjBXbEtUclBCND0%3D&ovuser=6a3548ab-7570-4271-91a8-58da00697029%2Cbencefarkas27%40edu.bme.hu to data/anklealign.zip
2025-12-13 15:45:35 URL:https://bmeedu-my.sharepoint.com/personal/gyires-toth_balint_vik_bme_hu/Documents/Dokumentumok/VITMMA19/2025/project-work/anklealign.zip?ga=1&LOF=1 [473095373/473095373] -> "data/anklealign.zip" [1]
Download completed successfully, unzipping to data
[run.sh] Starting full pipeline run at 2025-12-13T15:45:38+00:00
[run.sh] Running data preprocessing at 2025-12-13T15:45:38+00:00
2025-12-13 15:45:41,162 - INFO - Renaming files in folder: GI9Y8B
2025-12-13 15:45:41,176 - INFO - Renaming files in folder: FO6K58
2025-12-13 15:45:41,184 - INFO - Renaming files in folder: ODZF0M
2025-12-13 15:45:41,200 - INFO - Renaming files in folder: D6AE9F
2025-12-13 15:45:41,233 - INFO - Renaming files in folder: NX9GA4
2025-12-13 15:45:41,252 - INFO - Renaming files in folder: sample
2025-12-13 15:45:41,253 - INFO - Renaming files in folder: ECSGGY
2025-12-13 15:45:41,372 - INFO - Renaming files in folder: H51B9J
2025-12-13 15:45:41,422 - INFO - Renaming files in folder: B8V41Y
2025-12-13 15:45:41,431 - INFO - Renaming files in folder: OJHGS8
2025-12-13 15:45:41,453 - INFO - Renaming files in folder: C6037J
2025-12-13 15:45:41,487 - INFO - Renaming files in folder: FGWUFP
2025-12-13 15:45:41,516 - INFO - Renaming files in folder: NC1O2T
2025-12-13 15:45:41,516 - INFO - Renaming files in folder: ITWQ3V
2025-12-13 15:45:41,524 - INFO - Renaming files in folder: GK1XQ4
2025-12-13 15:45:41,535 - INFO - Renaming files in folder: XV0M8Z
2025-12-13 15:45:41,541 - INFO - No label file found in folder: GI9Y8B
2025-12-13 15:45:41,542 - INFO - Label file found: /app/data/anklealign/FO6K58/FO6K58_labels.json
2025-12-13 15:45:41,546 - INFO - Total entries updated: 32
2025-12-13 15:45:41,546 - INFO - Label file found: /app/data/anklealign/ODZF0M/project-2-at-2025-10-16-02-08-8ee4fdfa.json
2025-12-13 15:45:41,548 - INFO - Total entries updated: 20
2025-12-13 15:45:41,549 - INFO - Label file found: /app/data/anklealign/D6AE9F/D6AE9F.json
2025-12-13 15:45:41,551 - INFO - Total entries updated: 22
2025-12-13 15:45:41,551 - INFO - Label file found: /app/data/anklealign/NX9GA4/NX9GA4_ankles_labeled.json
2025-12-13 15:45:41,555 - INFO - Total entries updated: 20
2025-12-13 15:45:41,555 - INFO - Label file found: /app/data/anklealign/sample/project-1-at-2025-09-30-21-17-d687dfd4.json
2025-12-13 15:45:41,556 - INFO - Total entries updated: 2
2025-12-13 15:45:41,556 - INFO - No label file found in folder: ECSGGY
2025-12-13 15:45:41,557 - INFO - Label file found: /app/data/anklealign/H51B9J/H51B9J.json
2025-12-13 15:45:41,559 - INFO - Total entries updated: 23
2025-12-13 15:45:41,559 - INFO - Label file found: /app/data/anklealign/B8V41Y/b8v41y.json
2025-12-13 15:45:41,562 - INFO - Total entries updated: 20
2025-12-13 15:45:41,562 - INFO - Label file found: /app/data/anklealign/OJHGS8/OJHGS8.json
2025-12-13 15:45:41,564 - INFO - Total entries updated: 20
2025-12-13 15:45:41,564 - INFO - Label file found: /app/data/anklealign/C6037J/C6037J.json
2025-12-13 15:45:41,568 - INFO - Total entries updated: 34
2025-12-13 15:45:41,568 - INFO - Label file found: /app/data/anklealign/FGWUFP/FGWUFP.json
2025-12-13 15:45:41,571 - INFO - Total entries updated: 20
2025-12-13 15:45:41,571 - INFO - Label file found: /app/data/anklealign/NC1O2T/hf_labels_export.json
2025-12-13 15:45:41,573 - INFO - Total entries updated: 20
2025-12-13 15:45:41,573 - INFO - Label file found: /app/data/anklealign/ITWQ3V/ITWQ3V.json
2025-12-13 15:45:41,576 - INFO - Total entries updated: 23
2025-12-13 15:45:41,576 - INFO - Label file found: /app/data/anklealign/GK1XQ4/project-1-at-2025-10-15-23-46-9d203653.json
2025-12-13 15:45:41,582 - INFO - Total entries updated: 52
2025-12-13 15:45:41,582 - INFO - Label file found: /app/data/anklealign/XV0M8Z/AnkleAlign_Cimkezes_XV0M8Z.json
2025-12-13 15:45:41,585 - INFO - Total entries updated: 19
2025-12-13 15:45:41,590 - INFO - Total matched entries: 264
2025-12-13 15:45:41,591 - INFO - Total images in consensus: 57
2025-12-13 15:45:41,591 - INFO - Unique images (appearing exactly once): 49
2025-12-13 15:45:41,591 - INFO - Duplicate images removed: 8
2025-12-13 15:45:42,071 - INFO - Total unique consensus images: 49
2025-12-13 15:45:42,072 - INFO - Total training data: 241
2025-12-13 15:45:42,072 - INFO - Total testing data: 49
[run.sh] Running training at 2025-12-13T15:45:42+00:00
/opt/conda/lib/python3.11/site-packages/torch/cuda/__init__.py:182: UserWarning: CUDA initialization: Unexpected error from cudaGetDeviceCount(). Did you run some cuda functions before calling NumCudaDevices() that might have already set an error? Error 500: named symbol not found (Triggered internally at /pytorch/c10/cuda/CUDAFunctions.cpp:109.)
  return torch._C._cuda_getDeviceCount() > 0
2025-12-13 15:45:46,020 - INFO - CUDA not available
2025-12-13 15:45:46,020 - INFO - Device set to: cpu
2025-12-13 15:45:52,601 - INFO - Label mapping: {np.str_('1_Pronacio'): 0, np.str_('2_Neutralis'): 1, np.str_('3_Szupinacio'): 2}
2025-12-13 15:45:52,602 - INFO - Train loader size: 241
Training model:   0%|          | 0/50 [00:00<?, ?it/s]==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
BaseLineNetWork                          [32, 3]                   --
├─Sequential: 1-1                        [32, 32, 1, 1]            --
│    └─Conv2d: 2-1                       [32, 8, 112, 112]         80
│    └─ReLU: 2-2                         [32, 8, 112, 112]         --
│    └─Conv2d: 2-3                       [32, 16, 56, 56]          1,168
│    └─ReLU: 2-4                         [32, 16, 56, 56]          --
│    └─Conv2d: 2-5                       [32, 32, 28, 28]          4,640
│    └─ReLU: 2-6                         [32, 32, 28, 28]          --
│    └─AdaptiveAvgPool2d: 2-7            [32, 32, 1, 1]            --
├─Sequential: 1-2                        [32, 3]                   --
│    └─Flatten: 2-8                      [32, 32]                  --
│    └─Linear: 2-9                       [32, 128]                 4,224
│    └─ReLU: 2-10                        [32, 128]                 --
│    └─Linear: 2-11                      [32, 64]                  8,256
│    └─ReLU: 2-12                        [32, 64]                  --
│    └─Linear: 2-13                      [32, 3]                   195
==========================================================================================
Total params: 18,563
Trainable params: 18,563
Non-trainable params: 0
Total mult-adds (Units.MEGABYTES): 266.14
==========================================================================================
Input size (MB): 6.42
Forward/backward pass size (MB): 45.01
Params size (MB): 0.07
Estimated Total Size (MB): 51.50
==========================================================================================
2025-12-13 15:45:53,155 - INFO - Epoch 1/50, Train Loss: 1.0658
Training model:   2%|▏         | 1/50 [00:00<00:25,  1.91it/s]2025-12-13 15:45:53,671 - INFO - Epoch 2/50, Train Loss: 1.0092
Training model:   4%|▍         | 2/50 [00:01<00:24,  1.93it/s]2025-12-13 15:45:54,183 - INFO - Epoch 3/50, Train Loss: 0.9803
Training model:   6%|▌         | 3/50 [00:01<00:24,  1.94it/s]2025-12-13 15:45:54,691 - INFO - Epoch 4/50, Train Loss: 1.0133
Training model:   8%|▊         | 4/50 [00:02<00:23,  1.95it/s]2025-12-13 15:45:55,203 - INFO - Epoch 5/50, Train Loss: 1.0107
Training model:  10%|█         | 5/50 [00:02<00:23,  1.95it/s]2025-12-13 15:45:55,711 - INFO - Epoch 6/50, Train Loss: 0.9865
Training model:  12%|█▏        | 6/50 [00:03<00:22,  1.96it/s]2025-12-13 15:45:56,236 - INFO - Epoch 7/50, Train Loss: 0.9920
Training model:  14%|█▍        | 7/50 [00:03<00:22,  1.94it/s]2025-12-13 15:45:56,777 - INFO - Epoch 8/50, Train Loss: 0.9866
Training model:  16%|█▌        | 8/50 [00:04<00:21,  1.91it/s]2025-12-13 15:45:57,284 - INFO - Epoch 9/50, Train Loss: 0.9967
Training model:  18%|█▊        | 9/50 [00:04<00:21,  1.93it/s]Training model:  20%|██        | 10/50 [00:05<00:20,  1.94it/s]2025-12-13 15:45:57,792 - INFO - Epoch 10/50, Train Loss: 1.0015
Training model:  22%|██▏       | 11/50 [00:05<00:20,  1.93it/s]2025-12-13 15:45:58,319 - INFO - Epoch 11/50, Train Loss: 1.0389
2025-12-13 15:45:58,827 - INFO - Epoch 12/50, Train Loss: 1.0163
Training model:  24%|██▍       | 12/50 [00:06<00:19,  1.94it/s]Training model:  26%|██▌       | 13/50 [00:06<00:19,  1.95it/s]2025-12-13 15:45:59,337 - INFO - Epoch 13/50, Train Loss: 0.9987
2025-12-13 15:45:59,849 - INFO - Epoch 14/50, Train Loss: 0.9887
Training model:  28%|██▊       | 14/50 [00:07<00:18,  1.95it/s]2025-12-13 15:46:00,397 - INFO - Epoch 15/50, Train Loss: 0.9845
Training model:  30%|███       | 15/50 [00:07<00:18,  1.91it/s]2025-12-13 15:46:00,916 - INFO - Epoch 16/50, Train Loss: 0.9870
Training model:  32%|███▏      | 16/50 [00:08<00:17,  1.91it/s]2025-12-13 15:46:01,430 - INFO - Epoch 17/50, Train Loss: 0.9942
Training model:  34%|███▍      | 17/50 [00:08<00:17,  1.92it/s]2025-12-13 15:46:01,947 - INFO - Epoch 18/50, Train Loss: 0.9824
Training model:  36%|███▌      | 18/50 [00:09<00:16,  1.93it/s]2025-12-13 15:46:02,468 - INFO - Epoch 19/50, Train Loss: 0.9922
Training model:  38%|███▊      | 19/50 [00:09<00:16,  1.92it/s]2025-12-13 15:46:02,978 - INFO - Epoch 20/50, Train Loss: 0.9900
Training model:  40%|████      | 20/50 [00:10<00:15,  1.94it/s]Training model:  42%|████▏     | 21/50 [00:10<00:14,  1.94it/s]2025-12-13 15:46:03,489 - INFO - Epoch 21/50, Train Loss: 0.9823
2025-12-13 15:46:03,999 - INFO - Epoch 22/50, Train Loss: 0.9813
Training model:  44%|████▍     | 22/50 [00:11<00:14,  1.95it/s]2025-12-13 15:46:04,529 - INFO - Epoch 23/50, Train Loss: 0.9770
Training model:  46%|████▌     | 23/50 [00:11<00:13,  1.93it/s]2025-12-13 15:46:05,034 - INFO - Epoch 24/50, Train Loss: 0.9988
Training model:  48%|████▊     | 24/50 [00:12<00:13,  1.94it/s]2025-12-13 15:46:05,540 - INFO - Epoch 25/50, Train Loss: 0.9726
Training model:  50%|█████     | 25/50 [00:12<00:12,  1.95it/s]2025-12-13 15:46:06,044 - INFO - Epoch 26/50, Train Loss: 0.9917
Training model:  52%|█████▏    | 26/50 [00:13<00:12,  1.96it/s]2025-12-13 15:46:06,561 - INFO - Epoch 27/50, Train Loss: 0.9852
Training model:  54%|█████▍    | 27/50 [00:13<00:11,  1.95it/s]2025-12-13 15:46:07,114 - INFO - Epoch 28/50, Train Loss: 0.9778
Training model:  56%|█████▌    | 28/50 [00:14<00:11,  1.91it/s]2025-12-13 15:46:07,664 - INFO - Epoch 29/50, Train Loss: 0.9631
Training model:  58%|█████▊    | 29/50 [00:15<00:11,  1.88it/s]2025-12-13 15:46:08,178 - INFO - Epoch 30/50, Train Loss: 0.9625
Training model:  60%|██████    | 30/50 [00:15<00:10,  1.90it/s]2025-12-13 15:46:08,698 - INFO - Epoch 31/50, Train Loss: 0.9851
Training model:  62%|██████▏   | 31/50 [00:16<00:09,  1.91it/s]2025-12-13 15:46:09,244 - INFO - Epoch 32/50, Train Loss: 0.9805
Training model:  64%|██████▍   | 32/50 [00:16<00:09,  1.88it/s]2025-12-13 15:46:09,828 - INFO - Epoch 33/50, Train Loss: 0.9767
Training model:  66%|██████▌   | 33/50 [00:17<00:09,  1.83it/s]2025-12-13 15:46:10,361 - INFO - Epoch 34/50, Train Loss: 0.9686
Training model:  68%|██████▊   | 34/50 [00:17<00:08,  1.84it/s]2025-12-13 15:46:10,897 - INFO - Epoch 35/50, Train Loss: 0.9655
Training model:  70%|███████   | 35/50 [00:18<00:08,  1.85it/s]2025-12-13 15:46:11,414 - INFO - Epoch 36/50, Train Loss: 0.9790
Training model:  72%|███████▏  | 36/50 [00:18<00:07,  1.87it/s]2025-12-13 15:46:11,919 - INFO - Epoch 37/50, Train Loss: 0.9694
Training model:  74%|███████▍  | 37/50 [00:19<00:06,  1.90it/s]2025-12-13 15:46:12,440 - INFO - Epoch 38/50, Train Loss: 0.9625
Training model:  76%|███████▌  | 38/50 [00:19<00:06,  1.91it/s]2025-12-13 15:46:12,955 - INFO - Epoch 39/50, Train Loss: 0.9704
Training model:  78%|███████▊  | 39/50 [00:20<00:05,  1.92it/s]2025-12-13 15:46:13,462 - INFO - Epoch 40/50, Train Loss: 0.9634
Training model:  80%|████████  | 40/50 [00:20<00:05,  1.93it/s]2025-12-13 15:46:13,989 - INFO - Epoch 41/50, Train Loss: 0.9632
Training model:  82%|████████▏ | 41/50 [00:21<00:04,  1.92it/s]2025-12-13 15:46:14,536 - INFO - Epoch 42/50, Train Loss: 0.9492
Training model:  84%|████████▍ | 42/50 [00:21<00:04,  1.89it/s]2025-12-13 15:46:15,092 - INFO - Epoch 43/50, Train Loss: 0.9637
Training model:  86%|████████▌ | 43/50 [00:22<00:03,  1.86it/s]2025-12-13 15:46:15,611 - INFO - Epoch 44/50, Train Loss: 0.9537
Training model:  88%|████████▊ | 44/50 [00:22<00:03,  1.88it/s]2025-12-13 15:46:16,126 - INFO - Epoch 45/50, Train Loss: 0.9836
Training model:  90%|█████████ | 45/50 [00:23<00:02,  1.90it/s]2025-12-13 15:46:16,642 - INFO - Epoch 46/50, Train Loss: 0.9827
Training model:  92%|█████████▏| 46/50 [00:24<00:02,  1.91it/s]Training model:  94%|█████████▍| 47/50 [00:24<00:01,  1.80it/s]2025-12-13 15:46:17,274 - INFO - Epoch 47/50, Train Loss: 0.9529
2025-12-13 15:46:17,817 - INFO - Epoch 48/50, Train Loss: 0.9552
Training model:  96%|█████████▌| 48/50 [00:25<00:01,  1.81it/s]2025-12-13 15:46:18,380 - INFO - Epoch 49/50, Train Loss: 0.9654
Training model:  98%|█████████▊| 49/50 [00:25<00:00,  1.80it/s]2025-12-13 15:46:18,895 - INFO - Epoch 50/50, Train Loss: 0.9618
Training model: 100%|██████████| 50/50 [00:26<00:00,  1.84it/s]Training model: 100%|██████████| 50/50 [00:26<00:00,  1.90it/s]
2025-12-13 15:46:18,895 - INFO - [1.0657865554094315, 1.0092455968260765, 0.9803328141570091, 1.01328956335783, 1.0106681436300278, 0.9864838272333145, 0.9919840022921562, 0.9865653291344643, 0.9967193752527237, 1.0014672726392746, 1.0389346033334732, 1.0162629708647728, 0.9987150877714157, 0.988702654838562, 0.984466128051281, 0.9870192781090736, 0.9942339286208153, 0.9824327155947685, 0.9921939820051193, 0.9899552762508392, 0.9822661280632019, 0.9812854900956154, 0.976952075958252, 0.9988226294517517, 0.9726353585720062, 0.9916791617870331, 0.9851508438587189, 0.9778086319565773, 0.9630626365542412, 0.9624580964446068, 0.9850801527500153, 0.9804721474647522, 0.9766909405589104, 0.9685864821076393, 0.9654950201511383, 0.9790358766913414, 0.9693969041109085, 0.9624719545245171, 0.9703694880008698, 0.9634381011128426, 0.9631796851754189, 0.9492133036255836, 0.9636684581637383, 0.9536859765648842, 0.9835870414972305, 0.9827027171850204, 0.9528601691126823, 0.9551916718482971, 0.9653505384922028, 0.9617997780442238]
2025-12-13 15:46:18,898 - INFO - Baseline model weights saved to /app/src/models/baseline_weights.pth
2025-12-13 15:46:25,456 - INFO - Label mapping: {np.str_('1_Pronacio'): 0, np.str_('2_Neutralis'): 1, np.str_('3_Szupinacio'): 2}
2025-12-13 15:46:25,469 - INFO - Train loader size: 216
2025-12-13 15:46:25,469 - INFO - Validation loader size: 25
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
BestNetWork                              [32, 3]                   --
├─Sequential: 1-1                        [32, 64, 1, 1]            --
│    └─Conv2d: 2-1                       [32, 8, 224, 224]         80
│    └─BatchNorm2d: 2-2                  [32, 8, 224, 224]         16
│    └─ReLU: 2-3                         [32, 8, 224, 224]         --
│    └─MaxPool2d: 2-4                    [32, 8, 112, 112]         --
│    └─Conv2d: 2-5                       [32, 16, 112, 112]        1,168
│    └─BatchNorm2d: 2-6                  [32, 16, 112, 112]        32
│    └─ReLU: 2-7                         [32, 16, 112, 112]        --
│    └─MaxPool2d: 2-8                    [32, 16, 56, 56]          --
│    └─Conv2d: 2-9                       [32, 32, 56, 56]          4,640
│    └─BatchNorm2d: 2-10                 [32, 32, 56, 56]          64
│    └─ReLU: 2-11                        [32, 32, 56, 56]          --
│    └─MaxPool2d: 2-12                   [32, 32, 28, 28]          --
│    └─Conv2d: 2-13                      [32, 64, 28, 28]          18,496
│    └─BatchNorm2d: 2-14                 [32, 64, 28, 28]          128
│    └─ReLU: 2-15                        [32, 64, 28, 28]          --
│    └─MaxPool2d: 2-16                   [32, 64, 14, 14]          --
│    └─AdaptiveAvgPool2d: 2-17           [32, 64, 1, 1]            --
├─Sequential: 1-2                        [32, 3]                   --
│    └─Flatten: 2-18                     [32, 64]                  --
│    └─Linear: 2-19                      [32, 128]                 8,320
│    └─ReLU: 2-20                        [32, 128]                 --
│    └─Dropout: 2-21                     [32, 128]                 --
│    └─Linear: 2-22                      [32, 3]                   387
==========================================================================================
Total params: 33,331
Trainable params: 33,331
Non-trainable params: 0
Total mult-adds (Units.GIGABYTES): 1.53
==========================================================================================
Input size (MB): 6.42
Forward/backward pass size (MB): 385.39
Params size (MB): 0.13
Estimated Total Size (MB): 391.94
==========================================================================================
Training model:   0%|          | 0/50 [00:00<?, ?it/s]2025-12-13 15:46:27,941 - INFO - Epoch 1/50, Train Loss: 1.1604, Val Loss: 1.0358, Val Acc: 0.4000
Training model:   2%|▏         | 1/50 [00:02<01:54,  2.33s/it]2025-12-13 15:46:30,221 - INFO - Epoch 2/50, Train Loss: 1.0175, Val Loss: 1.0516, Val Acc: 0.4400
2025-12-13 15:46:30,221 - INFO - EarlyStopping counter: 1 out of 5
Training model:   4%|▍         | 2/50 [00:04<01:50,  2.30s/it]2025-12-13 15:46:32,548 - INFO - Epoch 3/50, Train Loss: 0.9675, Val Loss: 1.0532, Val Acc: 0.4400
2025-12-13 15:46:32,548 - INFO - EarlyStopping counter: 2 out of 5
Training model:   6%|▌         | 3/50 [00:06<01:48,  2.31s/it]2025-12-13 15:46:34,830 - INFO - Epoch 4/50, Train Loss: 1.0000, Val Loss: 1.0266, Val Acc: 0.4400
Training model:   8%|▊         | 4/50 [00:09<01:45,  2.30s/it]2025-12-13 15:46:37,278 - INFO - Epoch 5/50, Train Loss: 1.0003, Val Loss: 1.0125, Val Acc: 0.4400
Training model:  10%|█         | 5/50 [00:11<01:45,  2.35s/it]2025-12-13 15:46:39,601 - INFO - Epoch 6/50, Train Loss: 0.9780, Val Loss: 1.0241, Val Acc: 0.4000
2025-12-13 15:46:39,601 - INFO - EarlyStopping counter: 1 out of 5
Training model:  12%|█▏        | 6/50 [00:13<01:43,  2.34s/it]2025-12-13 15:46:42,066 - INFO - Epoch 7/50, Train Loss: 0.9448, Val Loss: 1.0116, Val Acc: 0.4400
2025-12-13 15:46:42,066 - INFO - EarlyStopping counter: 2 out of 5
Training model:  14%|█▍        | 7/50 [00:16<01:42,  2.38s/it]2025-12-13 15:46:44,388 - INFO - Epoch 8/50, Train Loss: 0.9429, Val Loss: 0.9914, Val Acc: 0.4000
Training model:  16%|█▌        | 8/50 [00:18<01:39,  2.36s/it]2025-12-13 15:46:46,689 - INFO - Epoch 9/50, Train Loss: 0.9353, Val Loss: 0.9903, Val Acc: 0.4400
Training model:  18%|█▊        | 9/50 [00:21<01:36,  2.34s/it]2025-12-13 15:46:49,164 - INFO - Epoch 10/50, Train Loss: 0.9620, Val Loss: 1.0242, Val Acc: 0.4000
2025-12-13 15:46:49,164 - INFO - EarlyStopping counter: 1 out of 5
Training model:  20%|██        | 10/50 [00:23<01:35,  2.38s/it]2025-12-13 15:46:51,468 - INFO - Epoch 11/50, Train Loss: 0.9320, Val Loss: 1.0165, Val Acc: 0.4400
2025-12-13 15:46:51,468 - INFO - EarlyStopping counter: 2 out of 5
Training model:  22%|██▏       | 11/50 [00:25<01:32,  2.36s/it]2025-12-13 15:46:53,780 - INFO - Epoch 12/50, Train Loss: 0.9382, Val Loss: 0.9882, Val Acc: 0.4800
Training model:  24%|██▍       | 12/50 [00:28<01:29,  2.35s/it]2025-12-13 15:46:56,086 - INFO - Epoch 13/50, Train Loss: 0.8791, Val Loss: 1.0031, Val Acc: 0.4400
2025-12-13 15:46:56,086 - INFO - EarlyStopping counter: 1 out of 5
Training model:  26%|██▌       | 13/50 [00:30<01:26,  2.33s/it]2025-12-13 15:46:58,379 - INFO - Epoch 14/50, Train Loss: 0.9305, Val Loss: 1.0103, Val Acc: 0.5200
2025-12-13 15:46:58,379 - INFO - EarlyStopping counter: 2 out of 5
Training model:  28%|██▊       | 14/50 [00:32<01:23,  2.32s/it]2025-12-13 15:47:00,781 - INFO - Epoch 15/50, Train Loss: 0.9402, Val Loss: 1.0249, Val Acc: 0.4400
2025-12-13 15:47:00,781 - INFO - EarlyStopping counter: 3 out of 5
Training model:  30%|███       | 15/50 [00:35<01:22,  2.35s/it]2025-12-13 15:47:03,103 - INFO - Epoch 16/50, Train Loss: 0.9239, Val Loss: 0.9952, Val Acc: 0.5200
2025-12-13 15:47:03,103 - INFO - EarlyStopping counter: 4 out of 5
Training model:  32%|███▏      | 16/50 [00:37<01:19,  2.34s/it]2025-12-13 15:47:05,403 - INFO - Epoch 17/50, Train Loss: 0.9161, Val Loss: 0.9899, Val Acc: 0.5200
2025-12-13 15:47:05,403 - INFO - EarlyStopping counter: 5 out of 5
2025-12-13 15:47:05,403 - INFO - Early stopping triggered
Training model:  32%|███▏      | 16/50 [00:39<01:24,  2.49s/it]
2025-12-13 15:47:05,405 - INFO - Loaded best model weights
2025-12-13 15:47:05,405 - INFO - [1.1604016593524389, 1.0174965006964547, 0.9675302079745701, 1.000047036579677, 1.0002604041780745, 0.9780389155660357, 0.9447798984391349, 0.9429315839494977, 0.9352687426975795, 0.961952941758292, 0.9320479461124965, 0.9382380247116089, 0.8791399768420628, 0.9305029170853751, 0.9402376413345337, 0.9238782780511039, 0.9161243523870196]
2025-12-13 15:47:05,407 - INFO - Best CNN weights saved to /app/src/models/best_cnn_weights.pth
[run.sh] Running evaluation at 2025-12-13T15:47:05+00:00
2025-12-13 15:47:08,907 - INFO - Calculating baseline (majority class) performance metrics
2025-12-13 15:47:08,908 - INFO - Majority class: 1_Pronacio
/opt/conda/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
2025-12-13 15:47:08,918 - INFO - Baseline balanced accuracy: 50.00%
2025-12-13 15:47:08,918 - INFO - Baseline precision: 2.04%
2025-12-13 15:47:08,918 - INFO - Baseline recall: 14.29%
2025-12-13 15:47:08,918 - INFO - Baseline F1-score: 3.57%
/opt/conda/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/opt/conda/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/opt/conda/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
2025-12-13 15:47:08,926 - INFO - Detailed Classification Report: 
              precision    recall  f1-score   support

  1_Pronacio       0.14      1.00      0.25         7
 2_Neutralis       0.00      0.00      0.00        42

    accuracy                           0.14        49
   macro avg       0.07      0.50      0.12        49
weighted avg       0.02      0.14      0.04        49

/opt/conda/lib/python3.11/site-packages/torch/cuda/__init__.py:182: UserWarning: CUDA initialization: Unexpected error from cudaGetDeviceCount(). Did you run some cuda functions before calling NumCudaDevices() that might have already set an error? Error 500: named symbol not found (Triggered internally at /pytorch/c10/cuda/CUDAFunctions.cpp:109.)
  return torch._C._cuda_getDeviceCount() > 0
2025-12-13 15:47:08,932 - INFO - CUDA not available
2025-12-13 15:47:08,932 - INFO - Device set to: cpu
2025-12-13 15:47:14,301 - INFO - Label mapping: {np.str_('1_Pronacio'): 0, np.str_('2_Neutralis'): 1}
2025-12-13 15:47:14,302 - INFO - Test loader size: 49
2025-12-13 15:47:14,308 - INFO - Model loaded from /app/src/models/baseline_weights.pth
2025-12-13 15:47:14,308 - INFO - Evaluating Baseline CNN on consensus test set
2025-12-13 15:47:14,350 - INFO - network balanced accuracy: 40.48%
2025-12-13 15:47:14,350 - INFO - network precision: 58.80%
2025-12-13 15:47:14,350 - INFO - network recall: 18.37%
2025-12-13 15:47:14,350 - INFO - network F1 score: 17.14%
2025-12-13 15:47:14,356 - INFO - Detailed Classification Report: 
              precision    recall  f1-score   support

           0       0.12      0.71      0.20         7
           1       0.67      0.10      0.17        42

    accuracy                           0.18        49
   macro avg       0.39      0.40      0.18        49
weighted avg       0.59      0.18      0.17        49

2025-12-13 15:47:14,440 - INFO - Best model loaded from /app/src/models/best_cnn_weights.pth
2025-12-13 15:47:14,440 - INFO - Evaluating Best CNN on consensus test set
2025-12-13 15:47:14,644 - INFO - network balanced accuracy: 50.00%
2025-12-13 15:47:14,644 - INFO - network precision: 75.51%
2025-12-13 15:47:14,644 - INFO - network recall: 24.49%
2025-12-13 15:47:14,644 - INFO - network F1 score: 24.49%
2025-12-13 15:47:14,650 - INFO - Detailed Classification Report: 
              precision    recall  f1-score   support

           0       0.14      0.86      0.24         7
           1       0.86      0.14      0.24        42

    accuracy                           0.24        49
   macro avg       0.50      0.50      0.24        49
weighted avg       0.76      0.24      0.24        49

[run.sh] Running inference at 2025-12-13T15:47:15+00:00
2025-12-13 15:47:18,240 - INFO - CUDA not available
2025-12-13 15:47:18,240 - INFO - Device set to: cpu
/opt/conda/lib/python3.11/site-packages/torch/cuda/__init__.py:182: UserWarning: CUDA initialization: Unexpected error from cudaGetDeviceCount(). Did you run some cuda functions before calling NumCudaDevices() that might have already set an error? Error 500: named symbol not found (Triggered internally at /pytorch/c10/cuda/CUDAFunctions.cpp:109.)
  return torch._C._cuda_getDeviceCount() > 0
2025-12-13 15:47:23,491 - INFO - Label mapping: {np.str_('1_Pronacio'): 0, np.str_('2_Neutralis'): 1}
2025-12-13 15:47:23,501 - INFO - Best model loaded from /app/src/models/best_cnn_weights.pth
2025-12-13 15:47:23,700 - INFO - Image: D6AE9F_sajat_reszvevo03_01.jpg, Predicted Label: 2_Neutralis
2025-12-13 15:47:23,700 - INFO - Image: D6AE9F_sajat_reszvevo03_02.jpg, Predicted Label: 2_Neutralis
2025-12-13 15:47:23,700 - INFO - Image: D6AE9F_sajat_reszvevo03_03.jpg, Predicted Label: 2_Neutralis
2025-12-13 15:47:23,700 - INFO - Image: D6AE9F_sajat_reszvevo03_04.jpg, Predicted Label: 1_Pronacio
2025-12-13 15:47:23,700 - INFO - Image: ECSGGY_sajat_reszvevo01_04.jpg, Predicted Label: 2_Neutralis
2025-12-13 15:47:23,700 - INFO - Image: ECSGGY_sajat_reszvevo02_02.jpg, Predicted Label: 1_Pronacio
2025-12-13 15:47:23,700 - INFO - Image: ECSGGY_sajat_reszvevo02_03.jpg, Predicted Label: 1_Pronacio
2025-12-13 15:47:23,700 - INFO - Image: ECSGGY_sajat_reszvevo02_04.jpg, Predicted Label: 1_Pronacio
2025-12-13 15:47:23,700 - INFO - Image: ECSGGY_sajat_reszvevo02_05.jpg, Predicted Label: 1_Pronacio
2025-12-13 15:47:23,700 - INFO - Image: ECSGGY_sajat_reszvevo06_01.jpg, Predicted Label: 1_Pronacio
2025-12-13 15:47:23,700 - INFO - Image: ECSGGY_sajat_reszvevo07_01.jpg, Predicted Label: 1_Pronacio
2025-12-13 15:47:23,700 - INFO - Image: ECSGGY_sajat_reszvevo08_01.jpg, Predicted Label: 2_Neutralis
2025-12-13 15:47:23,700 - INFO - Image: ECSGGY_sajat_reszvevo09_01.jpg, Predicted Label: 1_Pronacio
2025-12-13 15:47:23,700 - INFO - Image: ECSGGY_sajat_reszvevo09_02.jpg, Predicted Label: 1_Pronacio
2025-12-13 15:47:23,700 - INFO - Image: ECSGGY_sajat_reszvevo09_03.jpg, Predicted Label: 1_Pronacio
2025-12-13 15:47:23,700 - INFO - Image: ECSGGY_sajat_reszvevo_03_01.jpg, Predicted Label: 1_Pronacio
2025-12-13 15:47:23,701 - INFO - Image: ECSGGY_sajat_reszvevo_03_02.jpg, Predicted Label: 1_Pronacio
2025-12-13 15:47:23,701 - INFO - Image: ECSGGY_sajat_reszvevo_03_03.jpg, Predicted Label: 1_Pronacio
2025-12-13 15:47:23,701 - INFO - Image: ECSGGY_sajat_reszvevo_03_04.jpg, Predicted Label: 1_Pronacio
2025-12-13 15:47:23,701 - INFO - Image: ECSGGY_sajat_reszvevo_03_05.jpg, Predicted Label: 1_Pronacio
2025-12-13 15:47:23,701 - INFO - Image: ECSGGY_sajat_reszvevo_04_01.jpg, Predicted Label: 1_Pronacio
2025-12-13 15:47:23,701 - INFO - Image: ECSGGY_sajat_reszvevo_04_02.jpg, Predicted Label: 1_Pronacio
2025-12-13 15:47:23,701 - INFO - Image: ECSGGY_sajat_reszvevo_04_03.jpg, Predicted Label: 1_Pronacio
2025-12-13 15:47:23,701 - INFO - Image: ECSGGY_sajat_reszvevo_04_04.jpg, Predicted Label: 1_Pronacio
2025-12-13 15:47:23,701 - INFO - Image: ECSGGY_sajat_reszvevo_04_05.jpg, Predicted Label: 1_Pronacio
2025-12-13 15:47:23,701 - INFO - Image: ECSGGY_sajat_reszvevo_05_01.jpg, Predicted Label: 1_Pronacio
2025-12-13 15:47:23,701 - INFO - Image: ECSGGY_sajat_reszvevo_05_02.jpg, Predicted Label: 1_Pronacio
2025-12-13 15:47:23,701 - INFO - Image: ECSGGY_sajat_reszvevo_05_03.jpg, Predicted Label: 1_Pronacio
2025-12-13 15:47:23,701 - INFO - Image: ECSGGY_sajat_reszvevo_05_04.jpg, Predicted Label: 1_Pronacio
2025-12-13 15:47:23,701 - INFO - Image: ECSGGY_sajat_reszvevo_05_05.jpg, Predicted Label: 2_Neutralis
2025-12-13 15:47:23,701 - INFO - Image: FO6K58_sajat_resztvevo01_01.jpg, Predicted Label: 1_Pronacio
2025-12-13 15:47:23,701 - INFO - Image: FO6K58_sajat_resztvevo01_02.jpg, Predicted Label: 1_Pronacio
2025-12-13 15:47:23,701 - INFO - Image: FO6K58_sajat_resztvevo01_03.jpg, Predicted Label: 1_Pronacio
2025-12-13 15:47:23,701 - INFO - Image: FO6K58_sajat_resztvevo01_04.jpg, Predicted Label: 1_Pronacio
2025-12-13 15:47:23,701 - INFO - Image: FO6K58_sajat_resztvevo02_01.jpg, Predicted Label: 1_Pronacio
2025-12-13 15:47:23,701 - INFO - Image: FO6K58_sajat_resztvevo02_02.jpg, Predicted Label: 1_Pronacio
2025-12-13 15:47:23,701 - INFO - Image: FO6K58_sajat_resztvevo02_03.jpg, Predicted Label: 2_Neutralis
2025-12-13 15:47:23,701 - INFO - Image: FO6K58_sajat_resztvevo02_04.jpg, Predicted Label: 1_Pronacio
2025-12-13 15:47:23,701 - INFO - Image: FO6K58_sajat_resztvevo03_01.jpg, Predicted Label: 1_Pronacio
2025-12-13 15:47:23,701 - INFO - Image: FO6K58_sajat_resztvevo03_02.jpg, Predicted Label: 1_Pronacio
2025-12-13 15:47:23,702 - INFO - Image: FO6K58_sajat_resztvevo03_03.jpg, Predicted Label: 1_Pronacio
2025-12-13 15:47:23,702 - INFO - Image: FO6K58_sajat_resztvevo03_04.jpg, Predicted Label: 1_Pronacio
2025-12-13 15:47:23,702 - INFO - Image: FO6K58_sajat_resztvevo04_01.jpg, Predicted Label: 1_Pronacio
2025-12-13 15:47:23,702 - INFO - Image: FO6K58_sajat_resztvevo04_02.jpg, Predicted Label: 1_Pronacio
2025-12-13 15:47:23,702 - INFO - Image: FO6K58_sajat_resztvevo04_03.jpg, Predicted Label: 1_Pronacio
2025-12-13 15:47:23,702 - INFO - Image: FO6K58_sajat_resztvevo04_04.jpg, Predicted Label: 1_Pronacio
2025-12-13 15:47:23,702 - INFO - Image: FO6K58_sajat_resztvevo05_01.jpg, Predicted Label: 1_Pronacio
2025-12-13 15:47:23,702 - INFO - Image: FO6K58_sajat_resztvevo05_02.jpg, Predicted Label: 1_Pronacio
2025-12-13 15:47:23,702 - INFO - Image: FO6K58_sajat_resztvevo05_03.jpg, Predicted Label: 1_Pronacio
[run.sh] Pipeline finished at 2025-12-13T15:47:24+00:00
